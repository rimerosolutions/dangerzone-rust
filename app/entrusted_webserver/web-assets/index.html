<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name="author" content="Rimero Solutions Inc."/>
    <meta name="application-name" content="entrusted-web"/>
    <meta name="description" content="Entrusted Web Application"/>
    <title>Entrusted 0.2.7</title>
    <script>
      let fileList = new Array();
      let logByFileId = new Map();
      let isConverting = false;
      let translations = {
        "locale": "en",
        "data": {
          "l10n-imgquality-label": "PDF result visual quality",
          "l10n-imgquality-option-low": "low",
          "l10n-imgquality-option-medium": "medium",
          "l10n-imgquality-option-high": "high",
          "l10n-overall-progress": "Overall progress",
          "l10n-conversion-summary-succeeded": "All files processed successfully",
          "l10n-conversion-summary-one-failed": "file failed to process",
          "l10n-conversion-summary-multiple-failed": "files failed to process",
          "l10n-window-help-title": "Help",
          "l10n-window-help-program-reqs-line1": "The program requires a container solution:",
          "l10n-window-help-program-reqs-line2": "Docker (Windows, Linux, Mac OS)",
          "l10n-window-help-program-reqs-line3": "or Podman (Linux)",
          "l10n-window-help-program-reqs-line4": "or Lima (Mac OS)",
          "l10n-window-help-supported-docs-line1": "Supported document types:",
          "l10n-window-help-supported-docs-line2": "Images (.jpg, .jpeg, .gif, .png, .tif, .tiff)",
          "l10n-window-help-supported-docs-line3": "Document Graphics (.odg)",
          "l10n-window-help-supported-docs-line4": "Text Documents (.rtf, .doc, .docx, .odt)",
          "l10n-window-help-supported-docs-line5": "Spreadsheets (.xls, .xlsx, .ods)",
          "l10n-window-help-supported-docs-line6": "Presentations (.ppt, .pptx, .odp)",
          "l10n-window-help-more-info-line1": "For more information, please visit:",
          "l10n-window-help-more-info-line2": "https://github.com/rimerosolutions/entrusted",
          "l10n-window-password-title": "Set document password",
          "l10n-window-password-cancel-label": "Cancel",
          "l10n-window-password-accept-label": "Accept",
          "l10n-file-password-button-title": "Set document password (empty for none)",
          "l10n-file-deleted-from-server": "File deleted from server.",
          "l10n-window-logs-title": "Logs",
          "l10n-download-pdf-text": "Download trusted PDF",
          "l10n-download-pdf-title": "Once downloaded, the PDF will be permanently deleted from the server.",
          "l10n-logs": "Logs",
          "l10n-app-name": "Entrusted Web",
          "l10n-searchable-pdf-label": "Enable full-text search?",
          "l10n-ocrlang-select-label": "Yes, in:",
          "l10n-drop-files-line1": "Drop 'potentially suspicious' file(s) here",
          "l10n-drop-files-line2": "or",
          "l10n-drop-files-line3": "Click here to select file(s)",
          "l10n-filelist-column-filename-text": "File name",
          "l10n-filelist-column-progress-text": "Progress(%)",
          "l10n-filelist-column-status-text": "Status",
          "l10n-filelist-column-message-text": "Messages",
          "l10n-select-all": "Select all",
          "l10n-deselect-all": "Deselect all",
          "l10n-remove-selected-text": "Delete selection",
          "l10n-convert-documents": "Convert document(s)!",
          "l10n-settings": "Settings",
          "l10n-ocrlang-option-ar": "Afrikaans",
          "l10n-ocrlang-option-sqi": "Albanian",
          "l10n-ocrlang-option-amh": "Amharic",
          "l10n-ocrlang-option-ara": "Arabic",
          "l10n-ocrlang-option-Arabic": "Arabic script",
          "l10n-ocrlang-option-hye": "Armenian",
          "l10n-ocrlang-option-Armenian": "Armenian script",
          "l10n-ocrlang-option-asm": "Assamese",
          "l10n-ocrlang-option-aze": "Azerbaijani",
          "l10n-ocrlang-option-aze_cyrl": "Azerbaijani (Cyrillic)",
          "l10n-ocrlang-option-eus": "Basque",
          "l10n-ocrlang-option-bel": "Belarusian",
          "l10n-ocrlang-option-ben": "Bengali",
          "l10n-ocrlang-option-Bengali": "Bengali script",
          "l10n-ocrlang-option-bos": "Bosnian",
          "l10n-ocrlang-option-bre": "Breton",
          "l10n-ocrlang-option-bul": "Bulgarian",
          "l10n-ocrlang-option-mya": "Burmese",
          "l10n-ocrlang-option-Canadian_Aboriginal": "Canadian Aboriginal script",
          "l10n-ocrlang-option-cat": "Catalan",
          "l10n-ocrlang-option-ceb": "Cebuano",
          "l10n-ocrlang-option-chr": "Cherokee",
          "l10n-ocrlang-option-Cherokee": "Cherokee script",
          "l10n-ocrlang-option-chi_sim": "Chinese - Simplified",
          "l10n-ocrlang-option-chi_sim_vert": "Chinese - Simplified (vertical)",
          "l10n-ocrlang-option-chi_tra": "Chinese - Traditional",
          "l10n-ocrlang-option-chi_tra_vert": "Chinese - Traditional (vertical)",
          "l10n-ocrlang-option-cos": "Corsican",
          "l10n-ocrlang-option-hrv": "Croatian",
          "l10n-ocrlang-option-Cyrillic": "Cyrillic script",
          "l10n-ocrlang-option-ces": "Czech",
          "l10n-ocrlang-option-dan": "Danish",
          "l10n-ocrlang-option-Devanagari": "Devanagari script",
          "l10n-ocrlang-option-div": "Divehi",
          "l10n-ocrlang-option-nld": "Dutch",
          "l10n-ocrlang-option-dzo": "Dzongkha",
          "l10n-ocrlang-option-eng": "English",
          "l10n-ocrlang-option-enm": "English, Middle (1100-1500)",
          "l10n-ocrlang-option-epo": "Esperanto",
          "l10n-ocrlang-option-est": "Estonian",
          "l10n-ocrlang-option-Ethiopic": "Ethiopic script",
          "l10n-ocrlang-option-fao": "Faroese",
          "l10n-ocrlang-option-fil": "Filipino",
          "l10n-ocrlang-option-fin": "Finnish",
          "l10n-ocrlang-option-Fraktur": "Fraktur script",
          "l10n-ocrlang-option-frk": "Frankish",
          "l10n-ocrlang-option-fra": "French",
          "l10n-ocrlang-option-frm": "French, Middle (ca.1400-1600)",
          "l10n-ocrlang-option-fry": "Frisian (Western)",
          "l10n-ocrlang-option-gla": "Gaelic (Scots)",
          "l10n-ocrlang-option-glg": "Galician",
          "l10n-ocrlang-option-kat": "Georgian",
          "l10n-ocrlang-option-Georgian": "Georgian script",
          "l10n-ocrlang-option-deu": "German",
          "l10n-ocrlang-option-ell": "Greek",
          "l10n-ocrlang-option-Greek": "Greek script",
          "l10n-ocrlang-option-guj": "Gujarati",
          "l10n-ocrlang-option-Gujarati": "Gujarati script",
          "l10n-ocrlang-option-Gurmukhi": "Gurmukhi script",
          "l10n-ocrlang-option-Hangul": "Hangul script",
          "l10n-ocrlang-option-Hangul_vert": "Hangul (vertical) script",
          "l10n-ocrlang-option-HanS": "Han - Simplified script",
          "l10n-ocrlang-option-HanS_vert": "Han - Simplified (vertical) script",
          "l10n-ocrlang-option-HanT": "Han - Traditional script",
          "l10n-ocrlang-option-HanT_vert": "Han - Traditional (vertical) script",
          "l10n-ocrlang-option-hat": "Hatian",
          "l10n-ocrlang-option-heb": "Hebrew",
          "l10n-ocrlang-option-Hebrew": "Hebrew script",
          "l10n-ocrlang-option-hin": "Hindi",
          "l10n-ocrlang-option-hun": "Hungarian",
          "l10n-ocrlang-option-isl": "Icelandic",
          "l10n-ocrlang-option-ind": "Indonesian",
          "l10n-ocrlang-option-iku": "Inuktitut",
          "l10n-ocrlang-option-gle": "Irish",
          "l10n-ocrlang-option-ita": "Italian",
          "l10n-ocrlang-option-ita_old": "Italian - Old",
          "l10n-ocrlang-option-jpn": "Japanese",
          "l10n-ocrlang-option-Japanese": "Japanese script",
          "l10n-ocrlang-option-jpn_vert": "Japanese (vertical)",
          "l10n-ocrlang-option-Japanese_vert": "Japanese (vertical) script",
          "l10n-ocrlang-option-jav": "Javanese",
          "l10n-ocrlang-option-kan": "Kannada",
          "l10n-ocrlang-option-Kannada": "Kannada script",
          "l10n-ocrlang-option-kaz": "Kazakh",
          "l10n-ocrlang-option-khm": "Khmer",
          "l10n-ocrlang-option-Khmer": "Khmer script",
          "l10n-ocrlang-option-kor": "Korean",
          "l10n-ocrlang-option-kor_vert": "Korean (vertical)",
          "l10n-ocrlang-option-kur_ara": "Kurdish (Arabic)",
          "l10n-ocrlang-option-kir": "Kyrgyz",
          "l10n-ocrlang-option-lao": "Lao",
          "l10n-ocrlang-option-Lao": "Lao script",
          "l10n-ocrlang-option-lat": "Latin",
          "l10n-ocrlang-option-Latin": "Latin script",
          "l10n-ocrlang-option-lav": "Latvian",
          "l10n-ocrlang-option-lit": "Lithuanian",
          "l10n-ocrlang-option-ltz": "Luxembourgish",
          "l10n-ocrlang-option-mkd": "Macedonian",
          "l10n-ocrlang-option-mal": "Malayalam",
          "l10n-ocrlang-option-Malayalam": "Malayalam script",
          "l10n-ocrlang-option-msa": "Malay",
          "l10n-ocrlang-option-mlt": "Maltese",
          "l10n-ocrlang-option-mri": "Maori",
          "l10n-ocrlang-option-mar": "Marathi",
          "l10n-ocrlang-option-mon": "Mongolian",
          "l10n-ocrlang-option-Myanmar": "Myanmar script",
          "l10n-ocrlang-option-nep": "Nepali",
          "l10n-ocrlang-option-nor": "Norwegian",
          "l10n-ocrlang-option-oci": "Occitan (post 1500)",
          "l10n-ocrlang-option-kat_old": "Old Georgian",
          "l10n-ocrlang-option-Oriya": "Oriya (Odia) script",
          "l10n-ocrlang-option-ori": "Oriya",
          "l10n-ocrlang-option-pus": "Pashto",
          "l10n-ocrlang-option-fas": "Persian",
          "l10n-ocrlang-option-pol": "Polish",
          "l10n-ocrlang-option-por": "Portuguese",
          "l10n-ocrlang-option-pan": "Punjabi",
          "l10n-ocrlang-option-que": "Quechua",
          "l10n-ocrlang-option-ron": "Romanian",
          "l10n-ocrlang-option-rus": "Russian",
          "l10n-ocrlang-option-san": "Sanskrit",
          "l10n-ocrlang-option-osd": "script and orientation",
          "l10n-ocrlang-option-srp_latn": "Serbian (Latin)",
          "l10n-ocrlang-option-srp": "Serbian",
          "l10n-ocrlang-option-snd": "Sindhi",
          "l10n-ocrlang-option-Sinhala": "Sinhala script",
          "l10n-ocrlang-option-sin": "Sinhala",
          "l10n-ocrlang-option-slk": "Slovakian",
          "l10n-ocrlang-option-slv": "Slovenian",
          "l10n-ocrlang-option-spa_old": "Spanish, Castilian - Old",
          "l10n-ocrlang-option-spa": "Spanish",
          "l10n-ocrlang-option-sun": "Sundanese",
          "l10n-ocrlang-option-swa": "Swahili",
          "l10n-ocrlang-option-swe": "Swedish",
          "l10n-ocrlang-option-Syriac": "Syriac script",
          "l10n-ocrlang-option-syr": "Syriac",
          "l10n-ocrlang-option-tgk": "Tajik",
          "l10n-ocrlang-option-Tamil": "Tamil script",
          "l10n-ocrlang-option-tam": "Tamil",
          "l10n-ocrlang-option-tat": "Tatar",
          "l10n-ocrlang-option-Telugu": "Telugu script",
          "l10n-ocrlang-option-tel": "Telugu",
          "l10n-ocrlang-option-Thaana": "Thaana script",
          "l10n-ocrlang-option-Thai": "Thai script",
          "l10n-ocrlang-option-tha": "Thai",
          "l10n-ocrlang-option-Tibetan": "Tibetan script",
          "l10n-ocrlang-option-bod": "Tibetan Standard",
          "l10n-ocrlang-option-tir": "Tigrinya",
          "l10n-ocrlang-option-ton": "Tonga",
          "l10n-ocrlang-option-tur": "Turkish",
          "l10n-ocrlang-option-ukr": "Ukrainian",
          "l10n-ocrlang-option-urd": "Urdu",
          "l10n-ocrlang-option-uig": "Uyghur",
          "l10n-ocrlang-option-uzb_cyrl": "Uzbek (Cyrillic)",
          "l10n-ocrlang-option-uzb": "Uzbek",
          "l10n-ocrlang-option-Vietnamese": "Vietnamese script",
          "l10n-ocrlang-option-vie": "Vietnamese",
          "l10n-ocrlang-option-cym": "Welsh",
          "l10n-ocrlang-option-yid": "Yiddish",
          "l10n-ocrlang-option-yor": "Yoruba"
        }
      };

      function toggleOneSelection(source) {
        let found = false;

        for (let i = 0; i < fileList.length && !found; i++) {
          let fileObj = fileList[i];
          let chkFileId = "chk-" + fileObj.id;

          if (chkFileId == source.id) {
            found = true;
          }
        }

        if (found) {
          fireSelectionChange();
        }
      }

      function toggleSelection(selectedFlag) {
        let ret = false;

        for (let i = 0; i < fileList.length; i++) {
          let fileObj = fileList[i];
          let chkFileId = "chk-" + fileObj.id;
          let checkboxElement = document.getElementById(chkFileId);

          if (checkboxElement.checked != selectedFlag) {
            if (!checkboxElement.disabled) {
              checkboxElement.checked = selectedFlag;
            }
            ret = true;
          }
        }

        return ret;
      }

      function selectAll() {
        if (toggleSelection(true)) {
          fireSelectionChange();
        }
      }

      function selectedIndices() {
        let ret = [];

        for (let i = 0; i < fileList.length; i++) {
          let fileObj = fileList[i];
          let chkFileId = "chk-" + fileObj.id;
          let checkboxElement = document.getElementById(chkFileId);

          if (checkboxElement.checked && !checkboxElement.disabled) {
            ret.push(i);
          }
        }

        return ret;
      }

      function deleteSelection() {
        let indices = selectedIndices();
        let ret = false;

        while (indices.length != 0) {
          let i = indices.pop();

          let fileObj = fileList[i];
          let childElement = document.getElementById(fileObj.id);
          let parentElement = childElement.parentElement;

          logByFileId.delete(fileObj.id);
          parentElement.removeChild(childElement);
          fileList.splice(i, 1);

          ret = true;
        }

        if (ret) {
          fireSelectionChange();
        }
      }

      function fireSelectionChange() {
        let indices = selectedIndices();
        let noDataSelected = (indices.length == 0);
        let deleteButtonElement = document.getElementById("deleteButton");

        if (deleteButtonElement.disabled != noDataSelected) {
          deleteButtonElement.disabled = noDataSelected;
        }

        if (noDataSelected) {
          if (fileList.length == 0) {
            let submitButton = document.getElementById("submitButton");
            submitButton.disabled = true;
            let overallProgressElement = document.getElementById("overallProgress");
            overallProgressElement.value = 0;
            let conversionContainerElement = document.getElementById("conversionContainer");
            conversionContainerElement.className = "invisible";
            let overallProgressTableElement = document.getElementById("overallProgressTable");
            overallProgressTableElement.className = "invisible";
            let conversionSummaryElement = document.getElementById("conversionSummary");
            conversionSummaryElement.innerText = "";
            conversionSummaryElement.removeAttribute("class");

            let fileNameCountElement = document.getElementById("fileNameCount");
            fileNameCountElement.innerText = "";
          }
        }

        let fileNameCountElement = document.getElementById("fileNameCount");
        if (fileList.length == 0) {
          fileNameCountElement.innerText = "";
        } else {
          fileNameCountElement.innerText = "[" + fileList.length + "]";
        }
      }

      function deselectAll() {
        if (toggleSelection(false)) {
          fireSelectionChange();
        }
      }

      function preventDefaults(event) {
        event.preventDefault();
      }

      function fileSelectionChanged(event) {
        let fileButtonElement = document.getElementById("fileButton");
        updateFileList(fileButtonElement.files);
      }

      function findAncestorWithId(elemId, targetElement) {
        while (targetElement.id != elemId) {
          targetElement = targetElement.parentElement;
        }

        return targetElement;
      }

      function fileExplorer(event) {
        let targetElement = findAncestorWithId("dropFileZone", event.target);

        if (!targetElement.disabled) {
          let fileButton = document.getElementById("fileButton");
          fileButton.click();
        }
      }

      function uploadFile(event) {
        event.preventDefault();

        let targetElement = findAncestorWithId("dropFileZone", event.target);

        if (!targetElement.disabled) {
          let currentFileList = event.dataTransfer.files;

          if (isConverting) {
            isConverting = false;
            fileList.clear();
            let conversionSummaryElement = document.getElementById("conversionSummary");
            conversionSummaryElement.innerText = "";
            conversionSummaryElement.removeAttribute("class");
          }

          updateFileList(currentFileList);
        }
      }

      function resetFileListTable() {
        if (fileList.length == 0) {
          logByFileId.clear();
          let fileListTableBodyElement = document.getElementById("fileListTableBody");

          for (let i = fileListTableBodyElement.children.length - 1; i >= 0; i--) {
            fileListTableBodyElement.removeChild(fileListTableBodyElement.children[fileListTableBodyElement.children.length - 1]);
          }

          let fileListTableElement = document.getElementById("conversionContainer");
          fileListTableElement.className = "invisible";
          let overallProgressElement = document.getElementById("overallProgress");
          overallProgressElement.value = 0;
          let overallProgressTableElement = document.getElementById("overallProgressTable");
          overallProgressTableElement.className = "invisible";

          let conversionSummaryElement = document.getElementById("conversionSummary");
          conversionSummaryElement.innerText = "";
          conversionSummaryElement.removeAttribute("class");

          let fileNameCountElement = document.getElementById("fileNameCount");
          fileNameCountElement.innerText = "";
        }
      }

      function updateFileList(currentFileList) {
        if (fileList.length == 0) {
          resetFileListTable();
        }

        if (currentFileList != undefined) {
          let fileListTableElement = document.getElementById("conversionContainer");

          if (fileListTableElement.className != "visible") {
            fileListTableElement.className = "visible";
          }

          let submitButton = document.getElementById("submitButton");
          submitButton.disabled = false;
          let fileListTable = document.getElementById("fileListTableBody");
          let documentFragment = document.createDocumentFragment();

          for (let i = 0; i < currentFileList.length; i++) {
            let fileObj = {
              id: "file-" + Date.now() + "" + i,
              passwd: "",
              fileName: currentFileList[i].name,
              progressStatus: "0%",
              processingStatus: 'Pending',
              progressMessage: "",
              file: currentFileList[i]
            };

            fileList.push(fileObj);

            let columnData = [" ", fileObj.fileName, fileObj.progressStatus, fileObj.processingStatus, fileObj.progressMessage];
            let idPrefixes = ["passwd-", "filename-", "progress-status-", "processing-status-", "progress-message-"];
            let rowElement = document.createElement("tr");
            rowElement.id = fileObj.id;

            for (let j = 0; j < idPrefixes.length; j++) {
              let rowColumnElement = document.createElement("td");
              rowColumnElement.id = idPrefixes[j] + fileObj.id;

              if (idPrefixes[j].indexOf("passwd-") != -1) {
                rowColumnElement.classList.add("passwordFileIconContainer");
                let passwordElement = document.createElement("button");
                passwordElement.id = "passwd-btn-" + fileObj.id;
                passwordElement.title = translations["data"]["l10n-file-password-button-title"];
                passwordElement.className = "passwordFileIcon passwordNotSet";
                passwordElement.innerText = columnData[j];
                rowColumnElement.appendChild(passwordElement);
              } else if (idPrefixes[j].indexOf("filename-") != -1) {
                let checkboxElement = document.createElement("input");
                checkboxElement.type = "checkbox";
                checkboxElement.id = "chk-" + fileObj.id;
                checkboxElement.name = "chk" + fileObj.id;
                checkboxElement.className = "deleteFileIcon";
                rowColumnElement.appendChild(checkboxElement);

                let checkboxLabelElement = document.createElement("label");
                checkboxLabelElement.for = "chk-" + fileObj.id;
                checkboxLabelElement.innerText = columnData[j];
                rowColumnElement.appendChild(checkboxLabelElement);
              } else if (idPrefixes[j].indexOf("progress-status-") != -1) {
                let progressElement = document.createElement("progress");
                progressElement.id = "progress-" + fileObj.id;
                progressElement.value = 0;
                progressElement.max = 100;
                rowColumnElement.appendChild(progressElement);
              } else {
                if (idPrefixes[j].indexOf("processing-status-") != -1) {
                  rowColumnElement.className= "pending";
                }

                rowColumnElement.innerText = columnData[j];
              }

              rowElement.appendChild(rowColumnElement);
            }

            documentFragment.appendChild(rowElement);
          }

          fileListTable.appendChild(documentFragment);
        }

        let fileNameCountElement = document.getElementById("fileNameCount");
        fileNameCountElement.innerText = "[" + fileList.length + "]";
      }

      function toggleOcrCheckbox(source) {
        let ocrLangSelect = document.getElementById("ocrLangSelect");
        ocrLangSelect.disabled = !(source.checked);
      }

      function toggleSubmitButtonState() {
        let submitButton = document.getElementById("submitButton");
        submitButton.disabled = (fileList.length == 0);
      }

      function disableLinkListener(event) {
        let source = event.target;
        source.className = "visitedLink";
        source.title = translations["data"]["l10n-file-deleted-from-server"];
        source.removeEventListener("click", disableLinkListener);
      }

      function showHelpDialog(event) {
        let source = event.target;

        if (!(source.classList.contains("help") || source.classList.contains("helpContainer"))) {
          return;
        }

        function lineElements(lineL10nKeys) {
          let containerElement = document.createElement("div");
          let firstLine = document.createElement("p");
          firstLine.innerText = translations["data"][lineL10nKeys[0]];
          firstLine.className = "leftAligned";
          containerElement.appendChild(firstLine);

          for (let i = 1; i < lineL10nKeys.length; i++) {
            let line = document.createElement("li");
            line.innerText = translations["data"][lineL10nKeys[i]];
            line.className = "leftAligned";
            containerElement.appendChild(line);
          }

          let lastLine = document.createElement("br");
          containerElement.appendChild(lastLine);

          return containerElement
        }

        let modal = document.getElementById("modalWindow");
        let modalContent = document.getElementById("modalContent");
        let documentFragment = document.createDocumentFragment();

        let windowTitleElement = document.createElement("h3");
        windowTitleElement.innerText = translations["data"]["l10n-window-help-title"];
        documentFragment.appendChild(windowTitleElement);

        documentFragment.appendChild(lineElements([
          "l10n-window-help-program-reqs-line1",
          "l10n-window-help-program-reqs-line2",
          "l10n-window-help-program-reqs-line3",
          "l10n-window-help-program-reqs-line4"
        ]));

        documentFragment.appendChild(lineElements([
          "l10n-window-help-supported-docs-line1",
          "l10n-window-help-supported-docs-line2",
          "l10n-window-help-supported-docs-line3",
          "l10n-window-help-supported-docs-line4",
          "l10n-window-help-supported-docs-line5",
          "l10n-window-help-supported-docs-line6"
        ]));

        let moreInfoElementKeys = ["l10n-window-help-more-info-line1", "l10n-window-help-more-info-line2"];
        for (let i = 0; i < moreInfoElementKeys.length; i++) {
          let moreInfoElement = document.createElement("p");
          moreInfoElement.className = "leftAligned";

          if (i == 0) {
            moreInfoElement.innerText = translations["data"][moreInfoElementKeys[i]];
          } else {
            let pMoreInfoElement = document.createElement("a");
            pMoreInfoElement.setAttribute("href", translations["data"][moreInfoElementKeys[i]]);
            pMoreInfoElement.setAttribute("target", "_blank");
            pMoreInfoElement.innerText = translations["data"][moreInfoElementKeys[i]];
            moreInfoElement.appendChild(pMoreInfoElement);
          }

          documentFragment.appendChild(moreInfoElement);
          modalContent.appendChild(documentFragment);
          modal.style.display = "block";
        }
      }

      function promptForPassword(source) {
        let found = false;

        for (let i = 0; i < fileList.length && !found; i++) {
          let fileObj = fileList[i];
          let passwordElementId = "passwd-" + fileObj.id;
          let passwordButtonElementId = "passwd-btn-" + fileObj.id;

          if (passwordButtonElementId == source.id || passwordElementId == source.id) {
            found = true;
            let modal = document.getElementById("modalWindow");
            let modalContent = document.getElementById("modalContent");
            let documentFragment = document.createDocumentFragment();

            let windowTitleElement = document.createElement("h3");
            windowTitleElement.innerText = translations["data"]["l10n-window-password-title"];
            documentFragment.appendChild(windowTitleElement);

            let passwordContainerElement = document.createElement("div");
            let passwordInputElement = document.createElement("input");
            passwordInputElement.type = "password";
            passwordInputElement.value = fileObj.passwd;
            passwordContainerElement.appendChild(passwordInputElement);
            documentFragment.appendChild(passwordContainerElement);

            let buttonsContainerElement = document.createElement("div");

            let acceptButtonElement = document.createElement("button");
            acceptButtonElement.innerText = translations["data"]["l10n-window-password-accept-label"];
            acceptButtonElement.addEventListener("click", function(e) {
              fileObj.passwd = passwordInputElement.value;
              let passwordButtonElement = document.getElementById(passwordButtonElementId);

              if (fileObj.passwd.length == 0) {
                passwordButtonElement.classList.remove("passwordSet");
                passwordButtonElement.classList.add("passwordNotSet");
              } else {
                passwordButtonElement.classList.remove("passwordNotSet");
                passwordButtonElement.classList.add("passwordSet");
              }
              clearModalContents();
            });

            let cancelButtonElement = document.createElement("button");
            cancelButtonElement.innerText = translations["data"]["l10n-window-password-cancel-label"];
            cancelButtonElement.addEventListener("click", function(e) {
              clearModalContents();
            });

            buttonsContainerElement.appendChild(acceptButtonElement);
            buttonsContainerElement.appendChild(cancelButtonElement);
            documentFragment.appendChild(buttonsContainerElement);

            modalContent.appendChild(documentFragment);
            modal.style.display = "block";
          }
        }
      }

      function openLog(fileId) {
        let modal = document.getElementById("modalWindow");
        let modalContent = document.getElementById("modalContent");
        let logs = logByFileId.get(fileId) || [];
        let documentFragment = document.createDocumentFragment();
        let windowTitle = document.createElement("h3");

        windowTitle.innerText = translations["data"]["l10n-window-logs-title"];
        documentFragment.appendChild(windowTitle);

        for (let i = 0; i < logs.length; i++) {
          let logElement = document.createElement("li");
          logElement.innerText = logs[i].data;
          documentFragment.appendChild(logElement);
        }

        modalContent.appendChild(documentFragment);
        modal.style.display = "block";
      }

      function transitionStatusElement(element, value) {
        element.innerText = value;
        element.className = value.toLowerCase();
      }

      function submitOneFile(idx, failCount, fileObj, visualQuality, ocrSettings, uploadUrl) {
        let file = fileObj.file;
        let fileObjId = fileObj.id;
        let filename = fileObj.fileName;
        let newFailCount = failCount;

        let formData = new FormData();
        formData.append("file", file);
        formData.append("docpasswd", fileObj.passwd);
        formData.append("visualquality", visualQuality);
        formData.append("filename", filename);


        if (ocrSettings["ocrlang"] != null && ocrSettings["ocrlang"] != undefined) {
          formData.append("ocrlang", ocrSettings["ocrlang"]);
        }
                            
        let progressElement = document.getElementById("progress-" + fileObjId);
        let processingStatusElement = document.getElementById("processing-status-" + fileObjId);
        let progressMessageElement = document.getElementById("progress-message-" + fileObjId);
        let conversionSummaryElement = document.getElementById("conversionSummary");
        let overallProgressTableElement = document.getElementById("overallProgressTable");

        logByFileId.set(fileObjId, new Array());

        function onComplete(fileObjId, fileStatus, downloadLocation) {
          if (fileStatus.toLowerCase() == "failed") {
            newFailCount++;
          }

          let overallProgressElement = document.getElementById("overallProgress");
          let fprogressElement = document.getElementById("progress-" + fileObjId);
          let fprocessingStatusElement = document.getElementById("processing-status-" + fileObjId);

          fprogressElement.value = 100;
          transitionStatusElement(fprocessingStatusElement, fileStatus);

          let fprocessingMessageElement = document.getElementById("progress-message-" + fileObjId);
          fprocessingMessageElement.innerHTML = "";

          if (downloadLocation) {
            let downloadElement = document.createElement("a");
            downloadElement.target = "_blank";
            downloadElement.rel = "noopener noreferer";
            downloadElement.innerText = translations["data"]["l10n-download-pdf-text"];
            downloadElement.title = translations["data"]["l10n-download-pdf-title"];
            downloadElement.href = downloadLocation;
            downloadElement.addEventListener("click", disableLinkListener);
            fprocessingMessageElement.appendChild(downloadElement);

            let spacerElement = document.createElement("span");
            spacerElement.innerHTML = "&nbsp;|&nbsp;"
            fprocessingMessageElement.appendChild(spacerElement);
          }

          let fullLogElement = document.createElement("a");
          fullLogElement.innerText = translations["data"]["l10n-logs"];
          fullLogElement.href = "#";
          fullLogElement.addEventListener("click", function(e) {
            openLog(fileObjId);
          });
          fprocessingMessageElement.appendChild(fullLogElement);

          if (fileList.length != 0) {
            let total = idx + fileList.length + 1;
            if (overallProgressTableElement.className != "invisible") {
              let percentComplete = Math.max(1, ((idx + 1) * 100) / total);
              overallProgressElement.value = percentComplete.toFixed();
            }

            let nextFileObj = fileList.shift();
            let checkboxElement = document.getElementById("chk-" + nextFileObj.id);
            let passwdElement = document.getElementById("passwd-" + nextFileObj.id);
            checkboxElement.disabled = true;
            passwdElement.disabled = true;
            submitOneFile(++idx, newFailCount, nextFileObj, visualQuality, ocrSettings, uploadUrl);
          } else {
            let dropFileZoneElement = document.getElementById("dropFileZone");
            dropFileZoneElement.className = "dropFileZoneEnabled";
            dropFileZoneElement.disabled = false;

            if (overallProgressTableElement.className != "invisible") {
              overallProgressElement.value = 100;
            }

            let conversionSummaryClassName = (newFailCount != 0)? "failed" : "succeeded";
            conversionSummaryElement.className = conversionSummaryClassName;

            let conversionSummaryText = translations["data"]["l10n-conversion-summary-succeeded"];

            if (newFailCount == 1) {
              let tmp = translations["data"]["l10n-conversion-summary-one-failed"];
              conversionSummaryText = `${newFailCount} ${tmp}`;
            } else if (newFailCount > 1) {
              let tmp = translations["data"]["l10n-conversion-summary-multiple-failed"];
              conversionSummaryText = `${newFailCount} ${tmp}`;
            }

            conversionSummaryElement.innerText = conversionSummaryText;
          }
        }

        transitionStatusElement(processingStatusElement, "InProgress");
        let requestedLocale = translations["locale"];

        return fetch(uploadUrl, {
          method: "POST",
          body: formData,
          headers: {
            "Accept-Language": requestedLocale
          }
        }).then( response => {
          if (response.ok) {
            response.json().then(data => {
              let fileId = data.request_id
              let statusUrl = "." + data.tracking_uri;
              let sse = new EventSource(statusUrl);

              function handleSseError() {
                sse.close();
                onComplete(fileObjId, "Failed");
              }

              sse.addEventListener("processing_success", function(e) {
                sse.close();
                let n = JSON.parse(e.data);
                let downloadLocation = "." + n.data;
                onComplete(fileObjId, "Succeeded", downloadLocation);
              });

              sse.addEventListener("processing_failure", function(e) {
                handleSseError();
              });

              sse.addEventListener("error", function(e) {
                handleSseError();
              });

              sse.addEventListener("processing_update", function(e) {
                let ndata = e.data;

                try {
                  let n = JSON.parse(ndata);

                  if (n != undefined) {
                    logByFileId.get(fileObjId).push(n);
                    progressMessageElement.innerText = n.data;

                    if (n.percent_complete != 0) {
                      progressElement.value = n.percent_complete;
                    }
                  } else {
                    progressMessageElement.innerText = ndata;
                  }
                } catch (e) {
                  console.log("Cannot parse JSON payload:", ndata, ", error:", e);
                }
              });
            });
          } else {
            progressMessageElement.innerText = response.statusText;
            logByFileId.get(fileObjId).push({
              percent_complete: 100,
              data: response.statusText
            });
            onComplete(fileObjId, "Failed", null);
          }
        })
          .catch(function(error) {
            progressMessageElement.innerText = error;
            logByFileId.get(fileObjId).push({
              percent_complete: 100,
              data: error
            });
            onComplete(fileObjId, "Failed", null);
          });
      }

      function submitForm(source) {
        isConverting = true;
        source.disabled = true;

        let submitButtonElement = document.getElementById("submitButton");
        let dropFileZoneElement = document.getElementById("dropFileZone");
        let ocrCheckbox = document.getElementById("ocrCheckbox");
        let ocrLangSelect = document.getElementById("ocrLangSelect");
        let uploadForm = document.getElementById("uploadForm");
        let imgQualitySelectElement = document.getElementById("imgQualitySelect");
        let imageQuality = imgQualitySelectElement.value;
        let uploadUrl = uploadForm.action;

        let ocrSettings = {};

        if (ocrCheckbox.checked) {
          let ocrLangValues = [];

          for (let i = 0; i < ocrLangSelect.selectedOptions.length; i++) {
              ocrLangValues.push(ocrLangSelect.selectedOptions[i].value);                                                  
          }
                                                  
          if (ocrLangValues.length != 0) {
              ocrSettings.ocrlang = ocrLangValues.join("+");
          }
        }

        dropFileZoneElement.className = "dropFileZoneDisabled";
        dropFileZoneElement.disabled = true;
        submitButtonElement.disabled = true;

        let fileCount = fileList.length;
        let fileObj = fileList.shift();

        let rowElementIdsToDisable = ["chk-" + fileObj.id, "passwd-" + fileObj.id];
        for (let i = 0; i < rowElementIdsToDisable.length; i++) {
          let rowElementToDisable = document.getElementById(rowElementIdsToDisable[i]);
          rowElementToDisable.disabled = true;
        }

        if (fileCount > 1) {
           overallProgressTable.className = "visible";
        }

        submitOneFile(0, 0, fileObj, imageQuality, ocrSettings, uploadUrl);
      }

      function clearModalContents() {
        let modal = document.getElementById("modalWindow");
        let modalContent = document.getElementById("modalContent");

        for (let i = modalContent.children.length - 1; i > 0; i--) {
          modalContent.removeChild(modalContent.children[modalContent.children.length - 1]);
        }

        modal.style.display = "none";
      }

      function updateUiControls(data) {
        if (!data || !data.locale || !data.data) {
          document.body.className = "visible";
          return;
        }

        translations = data;

        let l10Elements = document.querySelectorAll('[data-l10n]');

        if (l10Elements) {
          for (let i = 0; i < l10Elements.length; i++) {
            let currentElement = l10Elements[i];
            let currentNodeName = currentElement.nodeName.toLowerCase();

            if (      currentNodeName == "p"
                      || currentNodeName == "label"
                      || currentNodeName == "span"
                      || currentNodeName == "h3"
                      || currentNodeName == "button"
                      || currentNodeName == "legend"
                      || currentNodeName == "th"
                      || currentNodeName == "a") {
              let l10nKey = currentElement.getAttribute("data-l10n");
              currentElement.innerText = translations["data"][l10nKey];
            } else if (currentNodeName == "select") {
              let l10nKey = currentElement.getAttribute("data-l10n");

              for (let j = 0; j < currentElement.options.length; j++) {
                let optionElement =  currentElement.options[j];
                let optionL10nKey = l10nKey + "-" + optionElement.value;
                optionElement.innerText = translations["data"][optionL10nKey];
              }
            }
          };
        }


        document.body.className = "visible";
      }

      function applyTranslationsOnPageLoad() {
        let requestedLocale = (navigator.language || navigator.userLanguage || "en");
        let requestedLocaleSimple = requestedLocale.split("-")[0];
        let translationsUri = "./uitranslations";

        if (requestedLocaleSimple != translations["locale"]) {
          fetch(translationsUri, {
            method: "GET",
            headers: {
              "Accept-Language": requestedLocale
            }
          }).then( function(response) {
            if (response.ok) {
              return response.json();
            } else {
              return translations;
            }
          }).then (function(data) {
            updateUiControls(data);
          }).catch(function(e) {
            updateUiControls(translations);
          });
        } else {
          updateUiControls(translations);
        }
      }



      window.addEventListener("DOMContentLoaded", function(event) {
        applyTranslationsOnPageLoad();

        let submitButton = document.getElementById("submitButton");
        let deleteButton = document.getElementById("deleteButton");
        deleteButton.disabled = true;
        submitButton.disabled = true;

        let modalCloseElement = document.getElementById("modalClose");
        modalCloseElement.addEventListener("click", function(evt) {
          clearModalContents();
        }, true);

        window.addEventListener("click", function(evt) {
          let x = evt.clientX;
          let y = evt.clientY;
          let modalContent = document.getElementById("modalContent");
          let rect = modalContent.getBoundingClientRect();

          if (!(rect.x <= x && rect.x + rect.width >= x && rect.y <= y && rect.y + rect.height >= y)) {
            clearModalContents();
          }
        }, true);

        let fileListTable = document.getElementById("fileListTable");
        fileListTable.addEventListener("click", function(evt) {
          let clickedElement = evt.target;

          if (clickedElement.classList.contains("deleteFileIcon")) {
            toggleOneSelection(clickedElement);
          } else if (clickedElement.classList.contains("passwordFileIconContainer")
                     || clickedElement.classList.contains("passwordFileIcon")) {
            promptForPassword(clickedElement);
          }
        }, true);
      }, true);
    </script>
    <style>
      .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          padding-top: 5%; /* Location of the box */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
      }

      /* Modal Content */
      .modal-content {
          background-color: #fefefe;
          text-align:center;
          margin: auto;
          padding: 5%;
          border: 1px solid #888;
          width: 80%;
          height: 70%;
          overflow:auto;
      }

      .modal-content li {
          text-align:left;
      }

      /* The Close Button */
      .close {
          color: #aaaaaa;
          float: right;
          font-size: 2em;
          font-weight: bold;
      }

      .leftAligned {
          text-align: left;
      }

      .close:hover,
      .close:focus {
          color: #000;
          text-decoration: none;
          cursor: pointer;
      }

      .row:after {
          float:left;
          text-align: left;
          content: "";
          display: table;
          clear: both;
      }

      .column {
          display: table;
          float: left;
          text-align: left;
      }

      body {
          background-color: #C8C8C8;
      }

      hr {
          width: 50%;
      }

      progress {
          width:80%;
          accent-color: yellow;
      }

      .filePasswordColumn {
          width: 2%;
      }

      .fileNameColumn {
          width: 30%;
      }

      .progressStatusColumn {
          width: 10%;
      }

      .processingStatusColumn {
          width: 10%;
      }

      .progressMessageColumn {
          width: 48%;
      }

      #dropFileZone {
          color: white;
          border: #999 2px solid;
          border-radius: 1em;
          height: 1%;
          font-size: 1em;
      }

      .dropFileZoneEnabled {
          background: red;
      }

      .dropFileZoneDisabled {
          background: #ffcccc;
      }

      #dragUploadFile {
          width: 50%;
          margin: 0 auto;
      }

      #dragUploadFile p {
          text-align: center;
      }

      #dragUploadFile #fileButton {
          display: none;
      }

      thead {
          vertical-align: top;
          border: 1px solid black;
      }

      thead tr {
          text-align: left;
          border: 1px solid black;
      }

      .title-text {
          text-align: center;
          color: maroon;
      }

      .deleteFileIcon {
      }

      .passwordNotSet {
          border: 1px solid yellow;
      }

      .passwordSet {
          border: 2px solid #8B0000;
      }

      .passwordFileIcon {
          background-size: cover;
          width: 20px;
          height: 20px;
          background-position: center center;
          background-repeat: no-repeat;
          background-image: url("data:image/png;base64,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");
      }

      #fileListTable {
          margin-top: 1%;
          overflow: auto;
          width: 100%;
      }

      .visitedLink {
          text-decoration: line-through;
      }

      .succeeded {
          accent-color: green;
          color: green;
      }

      .pending {
          color: magenta;
          accent-color: magenta;
      }

      .failed {
          color: red;
          accent-color: red;
      }

      .inprogress {
          color: #999900;
          accent-color: #999900;
      }

      .invisible {
          display: none;
      }

      .visible {
          display: visible;
      }

      fieldset {
          border: 1px solid black;
      }

      .helpContainer {
          width: 100%;
          text-align: right;
      }

      .help {
          position:absolute;
          right: 1%;
          top: 2%;
          color: white;
          width: 1%;
          background: blue;
          text-align: center;
      }

      legend {
          padding: 10px;
          background: darkgray;
          color: black;
      }

      #eventList {
          overflow: auto;
          margin: 0;
          padding: 10px 1px 1px 1px;
          background: yellow;
          border: 5px solid #977c27;
          font-family: monospace;
      }

      #eventList li {
          list-style-type: none;
          text-align: left;
          margin: 0;
          padding: 0;
      }

      .actionButton:disabled {
          background: #dbdbdb;
      }

      .actionButton {
          border: none;
          margin-left: 1%;
          padding: 15px 32px;
          text-align: center;
          text-decoration: none;
          background: white;
          display: inline-block;
          font-size: 16px;
      }
      
      td.vertical-align-center > * {
        vertical-align: middle;
      }

      .overallProgressLabel {
          color: #990000;
      }
    </style>
  </head>
  <body class="invisible">
    <noscript>Your browser does not support JavaScript!</noscript>
    <div id="modalWindow" class="modal">
      <div class="modal-content" id="modalContent">
        <span class="close" id="modalClose">&times;</span>
      </div>
    </div>
    <h3 class="title-text" data-l10n="l10n-app-name">Entrusted Web</h3>
    <br/>
    <div>
      <div class="helpContainer" onclick="showHelpDialog(event)"><p class="help">?</p></div>
      <br/>
      <form id="uploadForm" action="./api/v1/upload" method="post" enctype="multipart/form-data" onsubmit="preventDefaults(event)">
        <fieldset>
          <legend data-l10n="l10n-settings">Settings</legend>
          <table style="width:100%">
            <tbody>
              <tr style="width:100%">
                <td style="width:15%"><label for="imgQualitySelect"  data-l10n="l10n-imgquality-label">PDF result visual quality</label></td>
                <td>
                  <select id="imgQualitySelect" name="imgQualitySelect" data-l10n="l10n-imgquality-option">
                    <option value="low">low</option>
                    <option value="medium" selected>medium</option>
                    <option value="high">high</option>
                  </select>
                </td>
              </tr>
              <tr style="width:100%">
                <td style="width:15%">
                  <input type="checkbox" id="ocrCheckbox" name="ocr" onchange="toggleOcrCheckbox(this)" title="OCR (Optical character recognition) will be applied.">
                  <label for="ocrCheckbox" data-l10n="l10n-searchable-pdf-label">Make PDF searchable?</label>
                  <label for="ocrLangSelect" data-l10n="l10n-ocrlang-select-label">Yes, with language:</label>
                </td>
                <td class="vertical-align-center">                  
                  <select id="ocrLangSelect" name="ocrLangSelect" data-l10n="l10n-ocrlang-option" size="3" disabled multiple>
                    <option value="ar">Afrikaans</option>
                    <option value="sqi">Albanian</option>
                    <option value="amh">Amharic</option>
                    <option value="ara">Arabic</option>
                    <option value="Arabic">Arabic script</option>
                    <option value="hye">Armenian</option>
                    <option value="Armenian">Armenian script</option>
                    <option value="asm">Assamese</option>
                    <option value="aze">Azerbaijani</option>
                    <option value="aze_cyrl">Azerbaijani (Cyrillic)</option>
                    <option value="eus">Basque</option>
                    <option value="bel">Belarusian</option>
                    <option value="ben">Bengali</option>
                    <option value="Bengali">Bengali script</option>
                    <option value="bos">Bosnian</option>
                    <option value="bre">Breton</option>
                    <option value="bul">Bulgarian</option>
                    <option value="mya">Burmese</option>
                    <option value="Canadian_Aboriginal">Canadian Aboriginal script</option>
                    <option value="cat">Catalan</option>
                    <option value="ceb">Cebuano</option>
                    <option value="chr">Cherokee</option>
                    <option value="Cherokee">Cherokee script</option>
                    <option value="chi_sim">Chinese - Simplified</option>
                    <option value="chi_sim_vert">Chinese - Simplified (vertical)</option>
                    <option value="chi_tra">Chinese - Traditional</option>
                    <option value="chi_tra_vert">Chinese - Traditional (vertical)</option>
                    <option value="cos">Corsican</option>
                    <option value="hrv">Croatian</option>
                    <option value="Cyrillic">Cyrillic script</option>
                    <option value="ces">Czech</option>
                    <option value="dan">Danish</option>
                    <option value="Devanagari">Devanagari script</option>
                    <option value="div">Divehi</option>
                    <option value="nld">Dutch</option>
                    <option value="dzo">Dzongkha</option>
                    <option value="eng" selected>English</option>
                    <option value="enm">English, Middle (1100-1500)</option>
                    <option value="epo">Esperanto</option>
                    <option value="est">Estonian</option>
                    <option value="Ethiopic">Ethiopic script</option>
                    <option value="fao">Faroese</option>
                    <option value="fil">Filipino</option>
                    <option value="fin">Finnish</option>
                    <option value="Fraktur">Fraktur script</option>
                    <option value="frk">Frankish</option>
                    <option value="fra">French</option>
                    <option value="frm">French, Middle (ca.1400-1600)</option>
                    <option value="fry">Frisian (Western)</option>
                    <option value="gla">Gaelic (Scots)</option>
                    <option value="glg">Galician</option>
                    <option value="kat">Georgian</option>
                    <option value="Georgian">Georgian script</option>
                    <option value="deu">German</option>
                    <option value="ell">Greek</option>
                    <option value="Greek">Greek script</option>
                    <option value="guj">Gujarati</option>
                    <option value="Gujarati">Gujarati script</option>
                    <option value="Gurmukhi">Gurmukhi script</option>
                    <option value="Hangul">Hangul script</option>
                    <option value="Hangul_vert">Hangul (vertical) script</option>
                    <option value="HanS">Han - Simplified script</option>
                    <option value="HanS_vert">Han - Simplified (vertical) script</option>
                    <option value="HanT">Han - Traditional script</option>
                    <option value="HanT_vert">Han - Traditional (vertical) script</option>
                    <option value="hat">Hatian</option>
                    <option value="heb">Hebrew</option>
                    <option value="Hebrew">Hebrew script</option>
                    <option value="hin">Hindi</option>
                    <option value="hun">Hungarian</option>
                    <option value="isl">Icelandic</option>
                    <option value="ind">Indonesian</option>
                    <option value="iku">Inuktitut</option>
                    <option value="gle">Irish</option>
                    <option value="ita">Italian</option>
                    <option value="ita_old">Italian - Old</option>
                    <option value="jpn">Japanese</option>
                    <option value="Japanese">Japanese script</option>
                    <option value="jpn_vert">Japanese (vertical)</option>
                    <option value="Japanese_vert">Japanese (vertical) script</option>
                    <option value="jav">Javanese</option>
                    <option value="kan">Kannada</option>
                    <option value="Kannada">Kannada script</option>
                    <option value="kaz">Kazakh</option>
                    <option value="khm">Khmer</option>
                    <option value="Khmer">Khmer script</option>
                    <option value="kor">Korean</option>
                    <option value="kor_vert">Korean (vertical)</option>
                    <option value="kur_ara">Kurdish (Arabic)</option>
                    <option value="kir">Kyrgyz</option>
                    <option value="lao">Lao</option>
                    <option value="Lao">Lao script</option>
                    <option value="lat">Latin</option>
                    <option value="Latin">Latin script</option>
                    <option value="lav">Latvian</option>
                    <option value="lit">Lithuanian</option>
                    <option value="ltz">Luxembourgish</option>
                    <option value="mkd">Macedonian</option>
                    <option value="mal">Malayalam</option>
                    <option value="Malayalam">Malayalam script</option>
                    <option value="msa">Malay</option>
                    <option value="mlt">Maltese</option>
                    <option value="mri">Maori</option>
                    <option value="mar">Marathi</option>
                    <option value="mon">Mongolian</option>
                    <option value="Myanmar">Myanmar script</option>
                    <option value="nep">Nepali</option>
                    <option value="nor">Norwegian</option>
                    <option value="oci">Occitan (post 1500)</option>
                    <option value="kat_old">Old Georgian</option>
                    <option value="Oriya">Oriya (Odia) script</option>
                    <option value="ori">Oriya</option>
                    <option value="pus">Pashto</option>
                    <option value="fas">Persian</option>
                    <option value="pol">Polish</option>
                    <option value="por">Portuguese</option>
                    <option value="pan">Punjabi</option>
                    <option value="que">Quechua</option>
                    <option value="ron">Romanian</option>
                    <option value="rus">Russian</option>
                    <option value="san">Sanskrit</option>
                    <option value="osd">script and orientation</option>
                    <option value="srp_latn">Serbian (Latin)</option>
                    <option value="srp">Serbian</option>
                    <option value="snd">Sindhi</option>
                    <option value="Sinhala">Sinhala script</option>
                    <option value="sin">Sinhala</option>
                    <option value="slk">Slovakian</option>
                    <option value="slv">Slovenian</option>
                    <option value="spa_old">Spanish, Castilian - Old</option>
                    <option value="spa">Spanish</option>
                    <option value="sun">Sundanese</option>
                    <option value="swa">Swahili</option>
                    <option value="swe">Swedish</option>
                    <option value="Syriac">Syriac script</option>
                    <option value="syr">Syriac</option>
                    <option value="tgk">Tajik</option>
                    <option value="Tamil">Tamil script</option>
                    <option value="tam">Tamil</option>
                    <option value="tat">Tatar</option>
                    <option value="Telugu">Telugu script</option>
                    <option value="tel">Telugu</option>
                    <option value="Thaana">Thaana script</option>
                    <option value="Thai">Thai script</option>
                    <option value="tha">Thai</option>
                    <option value="Tibetan">Tibetan script</option>
                    <option value="bod">Tibetan Standard</option>
                    <option value="tir">Tigrinya</option>
                    <option value="ton">Tonga</option>
                    <option value="tur">Turkish</option>
                    <option value="ukr">Ukrainian</option>
                    <option value="urd">Urdu</option>
                    <option value="uig">Uyghur</option>
                    <option value="uzb_cyrl">Uzbek (Cyrillic)</option>
                    <option value="uzb">Uzbek</option>
                    <option value="Vietnamese">Vietnamese script</option>
                    <option value="vie">Vietnamese</option>
                    <option value="cym">Welsh</option>
                    <option value="yid">Yiddish</option>
                    <option value="yor">Yoruba</option>
                  </select>
                </td>
            </tbody>
          </table>
        </fieldset>
        <br/>
        <div id="dropFileZone" class="dropFileZoneEnabled" ondrop="uploadFile(event)" ondragover="return false" onclick="fileExplorer(event)">
          <div id="dragUploadFile">
            <p data-l10n="l10n-drop-files-line1">Drop 'potentially suspicious' file(s) here</p>
            <p data-l10n="l10n-drop-files-line2">or</p>
            <p data-l10n="l10n-drop-files-line3">Click here to select file(s)</p>
            <input type="file" name="fileButton" id="fileButton" onChange="fileSelectionChanged(event)" multiple>
          </div>
        </div>
      </form>
    </div>
    <br/>
    <div id="conversionContainer" class="invisible">
      <hr/>
      <table width="100%">
        <tbody>
          <tr>
            <td width="15%">
              <p><a href="#" onclick="selectAll()" data-l10n="l10n-select-all">Select all</a></p>
              <p><a href="#" onclick="deselectAll()" data-l10n="l10n-deselect-all">Deselect all</a></p>
            </td>
            <td width="35%">
              <button id="deleteButton" class="actionButton" onclick="deleteSelection()" data-l10n="l10n-remove-selected-text" disabled>Delete selection</button>
            </td>
            <td width="35%">
              <button onclick="submitForm(this)" id="submitButton" class="actionButton"  data-l10n="l10n-convert-documents" disabled>Convert document(s)!</button>
            </td>
            <td></td>
          </tr>
        </tbody>
      </table>
      <table width="100%" id="overallProgressTable" class="invisible">
        <tbody>
          <tr>
            <td width="15%">
              <span data-l10n="l10n-overall-progress" class="overallProgressLabel">Overall progress</span>
            </td>
            <td width="85%">
              <progress id="overallProgress" value="0" max="100"></progress>
            </td>
          </tr>
        </tbody>
      </table>
      <table id="fileListTable">
        <thead>
          <tr>
            <th class="filePasswordColumn"></th>
            <th class="fileNameColumn"><span data-l10n="l10n-filelist-column-filename-text">File name</span>&nbsp;<span id="fileNameCount"></th>
            <th class="progressStatusColumn" data-l10n="l10n-filelist-column-progress-text">Progress(%)</th>
            <th class="processingStatusColumn" data-l10n="l10n-filelist-column-status-text">Status</th>
            <th class="progressMessageColumn" data-l10n="l10n-filelist-column-message-text">Messages</th>
          </tr>
        </thead>
        <tbody id="fileListTableBody"></tbody>
      </table>
    </div>
    <p id="conversionSummary"></p>
  </body>
</html>
